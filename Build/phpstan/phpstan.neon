# PHPStan Configuration - TYPO3 LLM Extension
# Based on TYPO3 Best Practices: https://github.com/TYPO3BestPractices/tea
#
# This configuration enforces:
# - Level 10 maximum analysis (strictest type checking)
# - PHP 8.2+ compatibility
#
# Level 10 enforces complete type safety for all mixed types.
# Baseline used for new test files pending type improvements.

includes:
  - ../../phpstan-baseline.neon
  - ../../.Build/vendor/phpat/phpat/extension.neon

parameters:
  # PHP 8.2 (TYPO3 v13.4 minimum)
  phpVersion: 80200

  # Parallel execution (optimize for your CI environment)
  parallel:
    maximumNumberOfProcesses: 5

  # Analysis level (0-10, higher is stricter)
  # Level 10 is maximum strictness - full type safety enforcement
  level: 10

  # Paths to analyze
  paths:
    - ../../Classes
    - ../../Configuration
    - ../../Tests
    - ../../ext_localconf.php

  # PHPat architectural tests configuration
  phpat:
    ignore_built_in_classes: true

# PHPat test classes registration
services:
  -
    class: Netresearch\NrLlm\Tests\Architecture\DomainLayerTest
    tags:
      - phpat.test
  -
    class: Netresearch\NrLlm\Tests\Architecture\DtoLayerTest
    tags:
      - phpat.test
  -
    class: Netresearch\NrLlm\Tests\Architecture\ControllerLayerTest
    tags:
      - phpat.test
